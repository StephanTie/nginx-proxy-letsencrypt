# docker-compose for nginx-proxy-letsencrypt
Install script and Docker compose yml file for creating nginx proxy (from jwilder) with letsencrypt (from jrcs) to have a proxy service with ssl for php webapps generated by scriptcase (see my scriptcase repository https://github.com/StephanTie/scriptcase_prod.git)

Prerequisites Starting point: 
- Ensure versions are equal or higher for: 
- Ubuntu 18.04.4 LTS or higher with ufw, git and ssh installed
- docker version 18.09.7
- docker-compose 1.29.2

## Step 1 - Precautions for automatic iptable changes by docker.

When using docker first of all you do not want starting containers automatically opening ports and change the iptables. Also added standard dns.

edit daemon.json: 
```sh
sudo vi /etc/docker/daemon.json
```
```sh
{ "iptables" : false }

{ "dns": ["8.8.8.8", "8.8.8.4"] }
```
restart docker: 
```sh
sudo systemctl start docker
```

## Step 2 - Starting nginx-proxy-letsencrypt container with docker-compose 
This step creates docker network ${NETWORK) which is defined in .env 
Go to /data or any other place you want to keep your docker entities)
```sh
cd /data 
git clone https://github.com/StephanTie/nginx-proxy-letsencrypt.git
```

```sh
cd nginx-proxy-letsencrypt
sudo ./firststeponly.sh
```
## step 3 check
```sh
sudo docker-compose logs
```
## step 4 
Stop and start containers 
```sh
sudo docker-compose down
sudo docker-compose up -d
```
